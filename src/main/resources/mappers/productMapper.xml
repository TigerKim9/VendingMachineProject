<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.vendingMachine.Mapper.ProductMapper">

	<!-- 상품 등록 -->
	<insert id="addProduct" parameterType="com.vendingMachine.product.DTO.Product">
		INSERT INTO product(
			user_id,
			category_id,
			product_name,
			product_company_id,
			product_purchase_price,
			product_sell_price,
			product_reg_date
		)
		VALUES(
			#{userId},
			#{categoryId},
			#{productName},
			#{productCompanyId},
			#{productPurchasePrice},
			#{productSellPrice},
			NOW()
		)
	</insert>

	<!-- 상품 수정 -->
	<update id="updateProduct" parameterType="com.vendingMachine.product.DTO.Product">
		UPDATE product
		SET
			category_id = #{categoryId},
			product_name = #{productName},
			product_company_id = #{productCompanyId},
			product_purchase_price = #{productPurchasePrice},
			product_sell_price = #{productSellPrice}
		WHERE product_id = #{productId}
	</update>

	<!-- 상품 삭제 -->
	<delete id="deleteProduct">
		DELETE FROM product
		WHERE product_id = #{productId}
	</delete>

	<!-- 상품 단건 조회 -->
	<select id="getProductById" resultType="com.vendingMachine.product.DTO.Product">
		SELECT
			product_id productId,
			user_id userId,
			category_id categoryId,
			product_name productName,
			product_company_id productCompanyId,
			product_purchase_price productPurchasePrice,
			product_sell_price productSellPrice,
			product_reg_date productRegDate
		FROM product
		WHERE product_id = #{productId}
	</select>

	<!-- 상품 전체 조회 -->
	<select id="getAllProducts" resultType="com.vendingMachine.product.DTO.Product">
		SELECT
			product_id productId,
			user_id userId,
			category_id categoryId,
			product_name productName,
			product_company_id productCompanyId,
			product_purchase_price productPurchasePrice,
			product_sell_price productSellPrice,
			product_reg_date productRegDate
		FROM product
		ORDER BY product_reg_date DESC
	</select>

	<!-- 카테고리별 상품 조회 -->
	<select id="getProductsByCategory" resultType="com.vendingMachine.product.DTO.Product">
		SELECT
			product_id productId,
			user_id userId,
			category_id categoryId,
			product_name productName,
			product_company_id productCompanyId,
			product_purchase_price productPurchasePrice,
			product_sell_price productSellPrice,
			product_reg_date productRegDate
		FROM product
		WHERE category_id = #{categoryId}
		ORDER BY product_reg_date DESC
	</select>

	<!-- 사용자별 상품 조회 -->
	<select id="getProductsByUserId" resultType="com.vendingMachine.product.DTO.Product">
		SELECT
			product_id productId,
			user_id userId,
			category_id categoryId,
			product_name productName,
			product_company_id productCompanyId,
			product_purchase_price productPurchasePrice,
			product_sell_price productSellPrice,
			product_reg_date productRegDate
		FROM product
		WHERE user_id = #{userId}
		ORDER BY product_reg_date DESC
	</select>

	<!-- 상품명 검색 -->
	<select id="searchProductsByName" resultType="com.vendingMachine.product.DTO.Product">
		SELECT
			product_id productId,
			user_id userId,
			category_id categoryId,
			product_name productName,
			product_company_id productCompanyId,
			product_purchase_price productPurchasePrice,
			product_sell_price productSellPrice,
			product_reg_date productRegDate
		FROM product
		WHERE product_name LIKE CONCAT('%', #{productName}, '%')
		ORDER BY product_reg_date DESC
	</select>

	<!-- 카테고리 전체 조회 -->
	<select id="getAllCategories" resultType="com.vendingMachine.product.DTO.Category">
		SELECT
			category_id CategoryId,
			category_name CategoryName
		FROM category
		ORDER BY category_id
	</select>

	<!-- 카테고리 등록 -->
	<insert id="addCategory" parameterType="com.vendingMachine.product.DTO.Category">
		INSERT INTO category(category_name)
		VALUES(#{CategoryName})
	</insert>

	<!-- 카테고리 수정 -->
	<update id="updateCategory" parameterType="com.vendingMachine.product.DTO.Category">
		UPDATE category
		SET category_name = #{CategoryName}
		WHERE category_id = #{CategoryId}
	</update>

	<!-- 카테고리 삭제 -->
	<delete id="deleteCategory">
		DELETE FROM category
		WHERE category_id = #{categoryId}
	</delete>

</mapper>
